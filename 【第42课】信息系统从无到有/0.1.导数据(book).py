import win32com.client


books_data = [
    ('978-7-1153-0972-3', '宇宙之书——从托勒密、爱因斯坦到多重宇宙', '[英]约翰·D.巴罗', '科普', '2014-04-03', 10),
    ('978-7-3024-0433-0', '山海经', '孙见坤', '文学', '2015-11-01', 20),
    ('978-7-5379-6326-8', '中国的地形·壮美画卷', '贾文毓', '地理', '2015-02-01', 10),
    ('978-7-5624-9236-8', '天文之书', '吉姆·贝尔', '科普', '2015-10-25', 20),
    ('978-7-5193-0020-3', '中国通史“慢读”系列', '吕思勉', '历史', '2016-02-01', 10),
    ('978-7-5143-4589-6', '力学原来这么有趣！', '[日]大井喜久夫、大井操、三轮广明、松浦博和', '科普', '2016-05-01', 15),
    ('978-7-1001-1969-6', '西游记', '吴承恩', '小说', '1980-01-01', 20),
    ('978-7-0200-0872-8', '三国演义', '罗贯中', '小说', '1998-01-01', 20),
    ('978-7-5533-2335-0', '资治通鉴', '司马光', '历史', '2000-01-01', 15),
    ('978-7-5039-3471-1', '孙中山传', '尚明轩', '人物', '2008-03-01', 10),
    ('978-7-5499-8387-2', '教育写作', '颜莹', '教育', '2020-03-01', 20),
    ('978-7-5584-2000-9', '剑桥地球通史', '[英]克里斯托弗·劳埃德', '科普', '2020-09-01', 10),
    ('978-7-5168-2762-8', '趣说中国史：如果把中国422位皇帝放在一个群里，他们会聊些什么？', '趣哥', '历史', '2020-11-01', 10),
    ('978-7-2080-6164-4', '追风筝的人', '[美]卡勒德·胡赛尼', '小说', '2006-05-01', 10),
    ('978-7-5682-5561-5', '我们的中国(写给孩子的中国地理)', '洋洋兔', '百科全书', '2020-05-16', 10),
    ('978-7-5596-3024-7', '逆袭', '李源', '小说', '2018-07-03', 10),
    ('978-7-2011-6169-3', '蛤蟆先生去看心理医生', '[英]罗伯特·戴博德', '心理学', '2020-07-01', 10),
    ('978-1-0304-8407-7', '罗生门', '芥川龙之介', '小说', '2019-08-01', 10),
    ('978-7-5113-7951-1', '诗经名物图解', '细井徇', '文学', '2019-12-01', 10),
    ('978-7-5443-3479-2', '次第花开:藏人精神保持愉悦的秘密', '希阿荣博堪布', '哲学', '2011-03-01', 10),
    ('978-7-5534-1499-7', '古希腊演说辞全集-阿提卡演说家合辑', '[古希腊]安提丰', '文学', '2016-04-01', 10),
    ('978-7-5317-3898-5', '密丝特拉儿诗集', '[智利]密丝特拉儿', '文学', '2017-08-01', 10),
    ('978-7-5502-7357-3', '到山中去', '丰子恺', '文学', '2019-07-01', 10),
    ('978-7-5596-1229-8', '我是可爱的水母,我爱好放暗箭', '捷安特·潘达', '动漫', '2018-01-01', 10),
    ('978-7-5396-5608-3', '我弥留之际', '[美]威廉·福克纳', '小说', '2016-05-01', 10),
    ('978-7-5546-1442-6', '人间草木', '汪曾祺', '文学', '2018-02-01', 10),
    ('978-7-5015-8439-0', '红楼梦', '曹雪芹', '小说', '2015-04-01', 20),
    ('978-7-5442-6336-8', '今天也一直在看着你', '[日]角田光代', '文学', '2018-01-01', 10),
    ('978-7-1010-5146-9', '史记', '司马迁', '历史', '2006-06-01', 10),
    ('978-7-5325-4440-0', '孙子兵法', '孙武', '军事理论思想', '2006-07-01', 10),
    ('978-7-1010-5418-7', '论语', '孔子及其弟子', '语录体散文集', '2006-12-01', 10),
    ('978-7-2140-5019-9', '离骚', '屈原', '文学', '2009-11-01', 10),
    ('978-7-2240-3481-3', '道德经', '黄元吉', '哲学', '1996-10-10', 10),
    ('978-7-8015-8744-2', '曾国藩家书', '曾国藩', '书信集', '2006-04-01', 10),
    ('978-7-5327-3957-8', '瓦尔登湖', '[美]亨利·戴维·梭罗', '散文集', '2006-08-01', 10),
    ('978-7-8065-7851-3', '汤姆叔叔的小屋', '[美]斯托夫人', '小说', '2006-06-01', 10),
    ('978-7-1000-1648-3', '君主论', '[意大利]尼科洛·马基雅维里', '政治法律社会', '1985-07-01', 10),
    ('978-7-0200-3587-8', '红与黑', '[法]司汤达', '小说', '2002-01-01', 10),
    ('978-7-5302-1660-6', '黄金时代', '王小波', '小说', '2017-04-01', 10),
    ('978-7-8062-2285-0', '阿Q正传', '鲁迅', '小说', '2003-07-01', 10),
    ('978-7-5378-2342-5', '边城', '沈从文', '小说', '2002-04-01', 10),
    ('978-7-0200-2690-6', '白鹿原', '陈忠实', '文学', '1997-12-01', 10),
    ('978-7-2290-4206-6', '三体全集', '刘慈欣', '科幻小说', '2012-01-01', 10),
    ('978-7-5063-0974-5', '苏菲的世界', '[挪威]乔斯坦·贾德', '小说', '1996-01-01', 10),
    ('978-7-5327-5147-1', '局外人', '[法]阿尔贝·加缪', '小说', '2010-08-01', 10),
    ('978-7-5447-1391-7', '静静的顿河', '[苏]肖洛霍夫', '小说', '2010-09-01', 10),
    ('978-7-5001-3334-6', '西西弗斯神话', '[法]阿尔贝•加缪', '哲学论文集', '2013-01-01', 10),
    ('978-7-5426-3054-4', '动物庄园', '[英]乔治•奥威尔', '小说', '2009-06-01', 10),
    ('978-7-5321-3199-0', '简爱', '[英]夏洛蒂·勃朗特', '文学', '2007-08-01', 10),
    ('978-7-5442-5399-4', '百年孤独', '[哥伦比亚]加西亚·马尔克斯', '文学', '2011-06-01', 10),
    ('978-7-5063-7980-9', '双城记', '[英]查尔斯·狄更斯', '文学', '2015-08-01', 10),
    ('978-7-5080-4342-5', '唐吉诃德', '[西班牙]米盖尔·德·塞万提斯', '文学', '2007-10-01', 10),
    ('978-7-0200-1856-7', '雷雨', '曹禺', '戏剧', '1999-05-01', 10),
    ('978-7-5447-4504-8', '哈姆雷特', '[英]威廉·莎士比亚', '戏剧', '2013-12-01', 10),
    ('978-7-0200-3889-3', '罗密欧与朱丽叶', '[英]威廉·莎士比亚', '戏剧', '2003-01-01', 10),
    ('978-7-8056-7425-4', '钢铁是怎样炼成的', '[苏]尼古拉·阿列克谢耶维奇·奥斯特洛夫斯基', '小说', '1996-10-01', 10),
    ('978-7-0201-0449-9', '包法利夫人', '[法]福楼拜', '小说', '2003-01-01', 10),
    ('978-7-8065-7092-0', '飘', '[美]玛格丽特·米切尔', '小说', '2000-09-01', 10),
    ('978-7-5327-4197-7', '我是猫', '[日]夏目漱石', '文学', '2007-03-01', 10),
    ('978-7-8010-5353-4', '梦的解析', '[奥]西格蒙德·弗洛伊德', '科普', '1998-05-01', 10),
    ('978-9-5713-0118-1', '生命中不能承受之轻', '[捷克]米兰·昆德拉', '文学', '1988-11-15', 10),
    ('978-7-5327-4026-0', '在路上', '[美]杰克·凯鲁亚克', '小说', '2006-10-01', 10),
    ('978-7-5063-6543-7', '活着', '余华 ', '文学', '2012-08-01', 10),
    ('978-7-0200-4249-4', '小王子', '[法]安东尼·德·圣-埃克苏佩里', '文学', '2003-08-01', 10),
    ('978-7-1080-3151-8', '洞穴奇案', '[美]彼得·萨伯', '法哲学', '2009-06-01', 10),
    ('978-7-5357-3230-9', '时间简史', '[英]史蒂芬·霍金', '科普', '2010-04-01', 10),
    ('978-7-5382-7637-4', '上帝掷骰子吗', '曹天元', '科普', '2006-01-01', 10),
    ('978-7-5357-3270-5', '宇宙的琴弦', '[美]布赖恩·格林', '科普', '2004-08-01', 10),
    ('978-7-5357-3722-9', '生命是什么', '[奥]埃尔温•薛定谔', '科普', '2007-04-01', 10),
    ('978-7-2080-7400-2', '2001太空漫游', '[英]阿瑟·克拉克', '科普', '2007-11-01', 10),
    ('978-7-5004-2136-8', '通往奴役之路', '[英]弗里德利希・冯・哈耶克', '经济', '1997-08-01', 10),
    ('978-7-8010-9366-0', '乌合之众', '[法]勒庞', '社会心理学', '2014-05-01', 10),
    ('978-7-5327-2344-7', '老人与海', '[美]欧内斯特·海明威', '小说', '1999-10-01', 10),
    ('978-7-5063-3345-0', '随想录', '巴金', '文学', '2005-01-01', 10),
    ('978-7-2080-6215-3', '乡土中国', '费孝通', '社会学', '2006-04-01', 10),
    ('978-7-0200-0605-2', '少年维特的烦恼', '[德]约翰·沃尔夫冈·冯·歌德', '小说', '1999-07-01', 10),
    ('978-7-0201-0434-5', '悲惨世界', '[法]雨果', '小说', '2015-06-01', 10),
    ('978-7-5327-4007-9', '罪与罚', '[俄]费奥多尔·陀思妥耶夫斯基', '小说', '2006-08-01', 10),
    ('978-7-5327-7468-5', '美丽新世界', '[英]赫胥黎', '小说', '2017-06-01', 10),
    ('978-7-5354-3976-5', '一句顶一万句', '刘震云', '小说', '2009-03-01', 10),
    ('978-7-5339-3602-0', '月亮与六便士', '[英]威廉·萨默塞特·毛姆', '小说', '2017-01-01', 10),
    ('978-7-1000-4094-5', '如何阅读一本书', '[美]莫提默·J.艾德勒/查尔斯·范多伦', '教育', '2004-01-01', 10),
    ('978-7-5321-7231-3', '人类群星闪耀时', '[奥]斯蒂芬·茨威格', '历史', '2019-07-01', 10),
    ('978-7-1000-3725-9', '社会契约论', '卢梭', '政治哲学', '2003-02-01', 10),
    ('978-7-0200-2811-5', '骆驼祥子', '老舍', '小说', '2000-03-01', 10),
    ('978-7-5327-4475-6', '罗生门', '[日]芥川龙之介', '小说', '2008-07-01', 10),
    ('978-7-5327-3294-4', '喧哗与骚动', '[美]威廉·福克纳', '小说', '2004-08-01', 10),
    ('978-7-5339-1706-7', '变形记', '[奥]弗朗茨·卡夫卡', '小说', '2003-04-01', 10),
    ('978-7-2081-3321-1', '我的名字叫红', '[土耳其]奥尔罕·帕慕克', '小说', '2016-01-01', 10),
    ('978-7-5327-4922-5', '培根随笔', '[英]弗朗西斯·培根', '散文', '2010-03-01', 10),
    ('978-7-0200-8457-9', '尤利西斯', '[爱尔兰]詹姆斯·乔伊斯', '文学', '2012-05-01', 10),
    ('978-7-5447-3488-2', '癌症楼', '[俄]亚历山大•索尔仁尼琴', '文学', '2013-02-01', 10),
    ('978-7-5502-3043-9', '光明王', '[美]罗杰·泽拉兹尼', '科幻', '2015-03-15', 10),
    ('978-7-0201-0274-7', '战争与和平', '[俄]托尔斯泰 ', '历史', '2015-04-01', 10)
]

mdb_file = "Database.accdb"  # 数据库文件
conn = win32com.client.Dispatch(r"ADODB.Connection")  # 建立连接对象
DSN = 'PROVIDER = Microsoft.ACE.OLEDB.12.0;DATA SOURCE = {}'.format(mdb_file)  # Access2007及以后
conn.Open(DSN)  # 用游标打开数据连接

sql = """CREATE TABLE book(
            ISBN    VARCHAR(17) NOT NULL,
            书名     VARCHAR(200),
            作者     VARCHAR(100),
            类型     VARCHAR(20),
            出版日期  VARCHAR(10),
            数量     INT DEFAULT 0,
            PRIMARY KEY (ISBN))"""
try:
    conn.Execute(sql)  # 创建表[book]
except:
    conn.Execute("""DROP TABLE [book]""")  # 删除表[book]
    conn.Execute(sql)  # 创建表[book]

for data in books_data:
    rs = win32com.client.Dispatch(r'ADODB.Recordset')
    sql = """SELECT ISBN 
                 FROM book
                 WHERE ISBN='{}'""".format(data[0])
    rs.Open(sql, conn, 1, 1)

    if rs.EOF:
        sql = """INSERT INTO book (ISBN,书名,作者,类型,出版日期,数量)
                     VALUES {}""".format(data)
    else:
        sql = """UPDATE book
                     SET 数量=数量+{}
                     WHERE ISBN='{}'""".format(data[-1], data[0])   # 更新

    conn.Execute(sql)  # 执行sql语句

conn.Close()
